{"version":3,"file":"js/166.e4ae2001.js","mappings":"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","sources":["webpack://book-information-system/./src/views/HomeView/BookInfoBlock.vue?2719","webpack://book-information-system/./src/views/HomeView/BookInfoBlock.vue","webpack://book-information-system/./src/views/HomeView/index.vue?ec96","webpack://book-information-system/./src/views/HomeView/index.vue"],"sourcesContent":["import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-fb650702\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"book_info_block_root\" }\nconst _hoisted_2 = { class: \"img_wrap\" }\nconst _hoisted_3 = [\"src\"]\nconst _hoisted_4 = { class: \"info_wrap\" }\nconst _hoisted_5 = { class: \"title\" }\nconst _hoisted_6 = { class: \"author\" }\n\n\nexport default /*#__PURE__*/_defineComponent({\n  props: {\n  title: {\n    type: String,\n    required: true\n  },\n  author: {\n    type: String,\n    required: true\n  },\n  imgUrl: {\n    type: String,\n    required: true\n  }\n},\n  setup(__props) {\n\nconst props = __props\n\n\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"div\", _hoisted_2, [\n      _createElementVNode(\"img\", {\n        class: \"img\",\n        src: props.imgUrl\n      }, null, 8, _hoisted_3)\n    ]),\n    _createElementVNode(\"div\", _hoisted_4, [\n      _createElementVNode(\"div\", _hoisted_5, _toDisplayString(props.title), 1),\n      _createElementVNode(\"div\", _hoisted_6, _toDisplayString(props.author), 1)\n    ])\n  ]))\n}\n}\n\n})","import script from \"./BookInfoBlock.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./BookInfoBlock.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./BookInfoBlock.vue?vue&type=style&index=0&id=fb650702&lang=sass&scoped=true\"\n\nimport exportComponent from \"/home/runner/work/book-information-system/book-information-system/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-fb650702\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { createVNode as _createVNode, withCtx as _withCtx, unref as _unref, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createElementVNode as _createElementVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-23b495bf\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"home_view_root\" }\nconst _hoisted_2 = { class: \"main\" }\n\n\nimport * as TempRouter from '@/router'\n// 額外設置 name 屬性供 keep-alive 識別\n// setup-SFC 目前無法自動捕捉 fileName 來設定 name 屬性\n// ref issue: https://github.com/vuejs/core/issues/4993\nconst __default__ = {\n  name: TempRouter.RouterNameEnum.homeView\n}\nimport { ref } from 'vue'\nimport { useRouter } from 'vue-router'\nimport { RouterNameEnum } from '@/router'\nimport * as api from '@/api/books'\n\nimport BaseHeader from '@/components/BaseHeader.vue'\nimport BookInfoBlock from './BookInfoBlock.vue'\nimport UpdateBook from '@/components/UpdateBook.vue'\n\nimport useBooksInfo from './composables/useBooksInfo'\n\nimport type { BookInfo } from '@/api/books'\n\nexport default /*#__PURE__*/_defineComponent({\n  ...__default__,\n  setup(__props) {\n\nconst imgUrl = 'https://picsum.photos/800/600'\n\nconst { pageSetting, bookInfoGroup, getBooksInfo, initBooksInfo } = useBooksInfo()\n\nconst router = useRouter()\nconst routeToBookDetail = (bookInfoId: string) => {\n  const targetId = getBookId(bookInfoId as string)\n  router.push({ name: RouterNameEnum.detailView, params: { id: targetId } })\n}\n\nconst getBookId = (bookInfoId: string) => {\n  const targetId = bookInfoId.split('/')[2]\n  return targetId\n}\n\nconst handleBookInfoCreate = async (createObj: BookInfo) => {\n  const { data } = await api.createBookDetail(createObj)\n  initBooksInfo()\n  routeToBookDetail(data['@id'] as string)\n}\n\n// TODO: 做個載入動畫\nlet isLoading = ref<boolean>(false)\nconst handleScrollEvent = async () => {\n  // 需阻擋載入中狀態, 否則會多次觸發 callback fn\n  if (isLoading.value) return\n  // 若已載完所有資料則移除事件註冊\n  if (!pageSetting.value.hasNextPage) {\n    window.removeEventListener('scroll', handleScrollEvent)\n  }\n\n  // 滾動過的距離\n  const { scrollY } = window\n  // 螢幕高度\n  const screenHeight = window.screen.height\n  // 頁面總高度\n  const pageTotalHeight = document.body.scrollHeight\n  // 若滾動過的距離 + 螢幕高度 >= 頁面總高度, 則視同觸及底部\n  const isCloseBottom = scrollY + screenHeight >= pageTotalHeight\n  if (isCloseBottom) {\n    isLoading.value = true\n    await getBooksInfo()\n    isLoading.value = false\n  }\n}\nwindow.addEventListener('scroll', handleScrollEvent)\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createVNode(BaseHeader, { title: \"The book shelf\" }, {\n      right: _withCtx(() => [\n        _createVNode(UpdateBook, {\n          \"button-text\": \"Create\",\n          \"onCreate:bookInfo\": handleBookInfoCreate\n        })\n      ]),\n      _: 1\n    }),\n    _createElementVNode(\"main\", _hoisted_2, [\n      (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(bookInfoGroup), (bookInfo) => {\n        return (_openBlock(), _createElementBlock(\"div\", {\n          class: \"block_wrap\",\n          key: bookInfo.isbn\n        }, [\n          _createVNode(BookInfoBlock, {\n            title: bookInfo.title,\n            author: bookInfo.author,\n            \"img-url\": imgUrl,\n            onClick: ($event: any) => (routeToBookDetail(bookInfo.id))\n          }, null, 8, [\"title\", \"author\", \"onClick\"])\n        ]))\n      }), 128))\n    ])\n  ]))\n}\n}\n\n})","import script from \"./index.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./index.vue?vue&type=style&index=0&id=23b495bf&lang=sass&scoped=true\"\n\nimport exportComponent from \"/home/runner/work/book-information-system/book-information-system/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-23b495bf\"]])\n\nexport default __exports__"],"names":["_hoisted_1","class","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_defineComponent","props","title","type","String","required","author","imgUrl","setup","__props","_ctx","_cache","_openBlock","_createElementBlock","_createElementVNode","src","_toDisplayString","__exports__","__default__","name","TempRouter","pageSetting","bookInfoGroup","getBooksInfo","initBooksInfo","useBooksInfo","router","useRouter","routeToBookDetail","bookInfoId","targetId","getBookId","push","RouterNameEnum","params","id","split","handleBookInfoCreate","async","data","api","createObj","isLoading","ref","handleScrollEvent","value","hasNextPage","window","removeEventListener","scrollY","screenHeight","screen","height","pageTotalHeight","document","body","scrollHeight","isCloseBottom","addEventListener","_createVNode","BaseHeader","right","_withCtx","UpdateBook","_","_Fragment","_renderList","_unref","bookInfo","key","isbn","BookInfoBlock","onClick","$event"],"sourceRoot":""}